<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Timer</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg: transparent;
  --fg: #1a1a1a;
  --card-bg: #ffffff;
  --card-shadow: 0 1px 3px rgba(0,0,0,0.15);
  --btn-bg: #ffffff;
  --btn-fg: #1a1a1a;
  --btn-shadow: 0 1px 2px rgba(0,0,0,0.18);
  --input-border: rgba(0,0,0,0.3);
  --input-focus: rgba(0,0,0,0.7);
}

body.dark {
  --fg: #ffffff;
  --card-bg: #1a1a1a;
  --card-shadow: 0 1px 5px rgba(0,0,0,0.6);
  --btn-bg: #1e1e1e;
  --btn-fg: #ffffff;
  --btn-shadow: 0 6px 16px rgba(0,0,0,0.8);
  --input-border: rgba(255,255,255,0.25);
  --input-focus: rgba(255,255,255,0.7);
}

body {
  margin:0;
  padding:3px;
  height:95vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: var(--bg);
  color: var(--fg);
  font-family:"JetBrains Mono", monospace;
  box-sizing:border-box;
}

.timer-container {
  width:95vw;
  aspect-ratio:16/9;
  padding:4vw;
  border-radius:20px;
  background: var(--card-bg);
  box-shadow: var(--card-shadow);
  text-align:center;
  position:relative;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

.theme-toggle {
  position:absolute;
  top:12px;
  right:12px;
  padding:4px 12px;
  font-size:1rem;
  background: var(--btn-bg);
  color: var(--btn-fg);
  border-radius:999px;
  box-shadow: var(--btn-shadow);
  border:none;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:0.3em;
}

.display {
  font-size:13vw;
  font-weight:700;
  font-variant-numeric: tabular-nums;
  margin-bottom:3vw;
}

.input-group {
  display:flex;
  justify-content:center;
  align-items:center;
  gap:.6rem;
  margin-bottom:4px;
}

input {
  width:10vw;
  padding:0.8vw;
  background:transparent;
  color: var(--fg);
  font-size:2.5vw;
  text-align:center;
  font-weight:400;
  border:0.3vw solid var(--input-border);
  border-radius:3vw;
  outline:none;
}

input:focus {
  border-color: var(--input-focus);
  border-width:3px;
}

.input-label {
  font-size:2vw;
  opacity:.7;
}

button {
  font-family:inherit;
  font-size:2.5vw;
  padding:1vw 4vw;
  border:none;
  border-radius:999px;
  cursor:pointer;
  background: var(--btn-bg);
  color: var(--btn-fg);
  box-shadow: var(--btn-shadow);
  display:flex;
  justify-content:center;
  align-items:center;
  gap:0.3em;
  transition: background .2s, color .2s, opacity .15s;
}

button:hover { opacity:.8; }
button:active { opacity:.6; }

.controls {
  display:flex;
  justify-content:center;
  gap:.6rem;
  margin-top:14px;
}

svg { width:1.2em; height:1.2em; vertical-align:middle; }

#setBtn { font-size:2vw; padding:1vw 2vw; }
</style>
</head>

<body>
<div class="timer-container">
  <button class="theme-toggle" id="themeToggle">
    <svg id="themeIcon" viewBox="0 0 24 24" fill="currentColor">
      <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5Z"/>
    </svg>
  </button>

  <div class="display" id="display">00:00</div>

  <div class="input-group">
    <input type="number" id="minutesInput" min="0" max="999" value="0">
    <span class="input-label">m</span>
    <input type="number" id="secondsInput" min="0" max="59" value="0">
    <span class="input-label">s</span>
    <button id="setBtn">SET</button>
  </div>

  <div class="controls">
    <button class="play-pause-btn" id="playPauseBtn">
      <svg id="playPauseIcon" viewBox="0 0 16 16" fill="currentColor">
        <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"/>
      </svg>
    </button>
    <button id="resetBtn">RESET</button>
  </div>
</div>

<script>
let seconds=0, interval=null, isRunning=false;

const themeToggle=document.getElementById('themeToggle');
const themeIcon=document.getElementById('themeIcon');
const playPauseIcon=document.getElementById('playPauseIcon');
const display=document.getElementById('display');
const playPauseBtn=document.getElementById('playPauseBtn');
const resetBtn=document.getElementById('resetBtn');
const minutesInput=document.getElementById('minutesInput');
const secondsInput=document.getElementById('secondsInput');
const setBtn=document.getElementById('setBtn');

/* ---------------- Icons ---------------- */
const playIcon = `<path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"/>`;
const pauseIcon = `<path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5m5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5"/>`;

function updateIcons(){
  themeIcon.setAttribute('fill', document.body.classList.contains('dark')?'white':'black');
  playPauseIcon.innerHTML = isRunning?pauseIcon:playIcon;
  playPauseIcon.setAttribute('fill', document.body.classList.contains('dark')?'white':'black');
}

/* ---------------- Persistence ---------------- */
function savePrefs(){
  localStorage.setItem("theme",document.body.classList.contains('dark')?"dark":"light");
  localStorage.setItem("seconds",seconds);
  localStorage.setItem("minutesInput",minutesInput.value);
  localStorage.setItem("secondsInput",secondsInput.value);
  if(isRunning){
    localStorage.setItem("timerStart",Date.now());
    localStorage.setItem("timerDuration", seconds);
  }
}

function loadPrefs(){
  if(localStorage.getItem("theme")==="dark") document.body.classList.add("dark");
  const savedSeconds=parseInt(localStorage.getItem("seconds"));
  const savedMin=localStorage.getItem("minutesInput");
  const savedSec=localStorage.getItem("secondsInput");
  if(!isNaN(savedSeconds)) seconds=savedSeconds;
  if(savedMin!==null) minutesInput.value=savedMin;
  if(savedSec!==null) secondsInput.value=savedSec;

  const savedStart=localStorage.getItem("timerStart");
  const savedDuration=localStorage.getItem("timerDuration");
  if(savedStart && savedDuration){
    const elapsed=Math.floor((Date.now()-Number(savedStart))/1000);
    const remaining=Number(savedDuration)-elapsed;
    if(remaining>0){
      seconds=remaining;
      isRunning=true;
      start();
    } else { seconds=0; updateDisplay(); }
  }
}

function updateDisplay(){
  const m=Math.floor(seconds/60);
  const s=seconds%60;
  display.textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}

function start(){
  if(seconds===0) return;
  isRunning=true;
  updateIcons();
  savePrefs();
  interval=setInterval(()=>{
    if(seconds>0){ seconds--; updateDisplay(); }
    else { pause(); }
  },1000);
}

function pause(){
  isRunning=false;
  updateIcons();
  if(interval){ clearInterval(interval); interval=null; }
  savePrefs();
}

function togglePlayPause(){ isRunning?pause():start(); }

function reset(){
  pause();
  seconds=0;
  updateDisplay();
  minutesInput.value=0;
  secondsInput.value=0;
  savePrefs();
}

function setTime(){
  pause();
  const m=parseInt(minutesInput.value)||0;
  const s=parseInt(secondsInput.value)||0;
  seconds=m*60+s;
  updateDisplay();
  savePrefs();
}

/* ---------------- Events ---------------- */
playPauseBtn.addEventListener('click',togglePlayPause);
resetBtn.addEventListener('click',reset);
setBtn.addEventListener('click',setTime);
minutesInput.addEventListener('keypress', e=>e.key==='Enter'&&setTime());
secondsInput.addEventListener('keypress', e=>e.key==='Enter'&&setTime());
themeToggle.addEventListener('click',()=>{
  document.body.classList.toggle('dark');
  updateIcons();
  savePrefs();
});

/* ---------------- Init ---------------- */
loadPrefs();
updateIcons();
updateDisplay();
</script>
</body>
</html>
